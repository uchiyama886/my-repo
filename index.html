<!DOCTYPE html>
<html lang="ja">

<head>
    <title>GitHub CI/CD実践ガイド</title>
    <meta charset="utf-8">
</head>

<body>
    <header>
        <p>「GitHub CI/CD実践ガイド」の中で出てきた知識類をまとめたものです。</p>
        <p>もし忘れてもこれを見返して思い出してください。</p>
        <hr>
    </header>
    <div>
        <div id="Section1">
            <h3>第1章 CI/CDとは</h3>
            <p>・CIは継続的インテグレーションであり、コードの変更を頻繁にコードベースに統合して正しい動作をするかを繰り返し検証する。</p>
            <p>・CDは継続的デリバリーであり、いつでも安全にリリースできる状態を保ってソフトウェアを繰り返し改善する。</p>
            <p>・CI/CDによってソフトウェア開発のビルド、テスト、リリースまでの流れを自動化することができる。</p>
        </div>
        <div id="Section2">
            <h3>第2章 GitHub Actionsについて</h3>
            <p>・ワークフロー単位でタスクを自動化する。</p>
            <p>・ワークフローファイルは「.yml」,「.yaml」拡張子を使う。</p>
            <p>・YAMLファイルは、「.github/workflow」ディレクトリ直下に配置する。</p>
            <p>・GitHub Actionsはワークフロー、ジョブ、ステップなどから構成され、イベントをトリガーに指定したランナーで起動する。またステップではシェルコマンドやアクショを実行できる。</p>
            <p>・アクションは再利用可能コンポーネントでGitHub Marketplace は検索に便利、Verified Creatorsは選択時の判断材料になる。</p>
        </div>
        <div id="Section3">
            <h3>第3章 GitHub Actionsの基本記法</h3>
            <p>・コンテキストやデフォルト環境変数からワークフロー実行時の情報などから取得可能。コンテキストの参照は中間環境変数を使うと便利。</p>
            <p>・ワークフロー間で共有する値はVariablesやSecretsで管理する。Secretsは暗号化されて、ログもマスクされる。</p>
            <p>・${{ <expression> }}といった記述を式と呼び、ワークフロー実行時に評価される。式ではリテラルや演算子、関数が利用でき、関数では文字列比較やJSON操作などが可能である。</p>
            <p>・条件分岐も可能で、エラー発生時の挙動も記述できる。</p>
            <p>・ステップ間でデータ共有をするにはGITHUB_OUTPUT環境変数やGITHUB_ENV環境変数を使う。前者はステップidを設定することで依存関係がわかりやすく、後者はステップidを設定する必要がないがグローバル変数になる、といった特徴がある。
            </p>
            <p>・GitHub APIはcurlコマンドなどのプログラムからプルリクエストへのコメントやラベル付与を、ワークフローで実行できる機能で、GITHUB_TOKENによる認証が必要。</p>
            <p>・GITHUB_TOKENはワークフロー実行時に発行され、アクセスを許可するリソースや操作はパーミッションで定義するが、自リポジトリ以外にはアクセスできない。</p>
            <p>・スターターワークフローには、便利なリファレンスが提供されている。</p>
        </div>
        <div id="Section4">
            <h3>第4章 CIの実践</h3>
            <p>・CIはプルリクエスト時に実行されることが多い。</p>
            <p>・テストワークフローの基本は、チェックアウト→言語セットアップ→テストの順。</p>
            <p>・フィルターやアクティビティタイプでワークフローの起動条件を制御可能。</p>
            <p>・静的解析はコードスキャンをして問題検出する、actionlintを使えば常に静的解析ができる。</p>
            <p>・タイムアウトはデフォルトで6時間のため、常に設定しておく。</p>
            <p>・シェルの指定はステップごとに可能。パイプエラーを拾うために常に定義するべき。</p>
            <p>・Concurrencyを使えば多重起動の抑制や自動キャンセルが可能。</p>
            <p>・CIの黄金律は、「クリーンに保つ」、「高速に実行する」,「ノイズを減らす」の３つ。</p>
            <p>・ユニットテストを中心に、フレーキーテストやフラジャイルテストの放置は御法度。</p>
            <p>・スローテストは実行タイミングをずらしてテストツールで実行時の挙動を制御する。</p>
        </div>
        <div id="Section5">
            <h3>第5章 運用しやすいワークフローの設計</h3>
            <p>・GitHub Actionsではステップデバッグログとランナー診断ログを出力でき、ワークフローコマンドで自分でも出力可能。</p>
            <p>・Bashのトレーシングオプションを使えば手軽に情報量を増やせる。ログ流出が多い場合はグループ化する。</p>
            <p>・アノテーションやジョブサマリーを活用すれば重要な情報を素早く確認できる。チャット通知はタイムリーに情報把握できる。</p>
            </p>
            <p>・複数ジョブを起動するとことも、ジョブの依存関係の定義で逐次実行やジョブ間のデータの受け渡しも可能。</p>
            <p>・マトリックスで、単一のジョブ定義で複数ジョブを実行できる。</p>
            <p>・Environmentsを使えば、環境ごとにVariablesやSecretsを管理できる。</p>
            <p>・キャッシュアクションで細かくキャッシュを制御できる。</p>
            <p>・キャッシュキーの設計が重要。</p>
            <p>・キャッシュは手動で削除できる。</p>
            <p>・GitHubが提供するストレージにアーティファクトを一時保存可能</p>
        </div>
        <div id="Section6">
            <h3>第6章　アクションによるモジュール化</h3>
            <p>・Composite Action・JavaScript Action・Docker Container Actionのいずれかでアクションを実装する。</p>
            <p>・Composite Actionが最も簡単で、ワークフロー構文と似た記述で実装可能。</p>
            <p>・アクションの実装方法に関わらず、メタデータファイルが必要で、ファイル名はaction.yaml(action.yml)である。</p>
            <p>・リモートアクションは独立したリポジトリへ配置し、ローカルアクションはワークフローと同じリポジトリへ配置する。</p>
            <p>・ローカルアクションを呼び出す前に、ソースコードをチェックアウトし、usesキーには「./」で始まるパスを指定する必要がある。</p>
            <p>・アクションの可視性はリポジトリの可視性と連動している。</p>
            <p>・アクションにはメタデータファイルが必須。メタデータファイルの実装には、メタデータ構文を使う。</p>
            <p>・メタデータファイルは任意のディレクトリに配置可能。</p>
            <p>・メタデータ構文にはメインロジックや入出力インターフェイスを記述する。</p>
            <p>・メタデータ構文はワークフロー構文と似てるが、shellキーが省略できない、VariablesやSecretsにアクセスできない。</p>
            <p>・認知負荷を下げるためにアクションの名前と概要にこだわるべし。</p>
            <p>・GITHUB_TOKENが必要なら、github.tokenプロパティを使う。また切り出したスクリプトの参照にはGITHUB_ACTION_PATH環境変数を使う。</p>
            <p>・アクションでは環境変数への依存を避けて、ログはグループ化するべし。</p>
        </div>
        <div id="Section7">
            <h3>第7章</h3>
            <p>・</p>
        </div>
        <div id="Section8">
            <h3></h3>
            <p>・</p>
        </div>
    </div>
    </div>
</body>

</html>